<?php 
  include './conn.php';
  if(isset($_POST['add'])){
    $name = $_POST['name'];
    $uname = $_POST['username'];
    $pw = $_POST['password'];
    $gender = $_POST['gender'];
    $email = $_POST['email'];
    $age = $_POST['age'];
    $img = $_FILES['profile'];

    if($img['size'] == 0){
      $img = 'avatar.jpg';
      $qry = mysqli_query($con, "INSERT INTO users VALUES ('', '$name', '$uname', '$gender', '$email', '$age', '$pw', '$img')");
      if($qry) {
        header('location: ./');
      }
    } else {
      $imgname = $img['name'];
      $tmp = $img['tmp_name'];
      $folder = '../img/profiles/users/'.$imgname;
      $move = move_uploaded_file($tmp, $folder);
      if($move){
        $qry = mysqli_query($con, "INSERT INTO users VALUES ('', '$name', '$uname', '$gender', '$email', '$age', '$pw', '$imgname')");
        if($qry) {
          header('location: ./');
        }
      }
    }

    // $qry = mysqli_query($con, "INSERT INTO users VALUES ('', '$name', '$uname', '$gender', '$email', '$age', '$pw')");
    // if($qry) {
    //   header('location: ./');
    // }
    // if($img == ){
    //   echo 'Empty';
    // }
  }
?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meet-Me Date App</title>
  <link rel="stylesheet" href="../scss/style.css">
  <link rel="shortcut icon" href="../img/main/logo.svg" type="image/x-icon">
</head>
<body>
  <main>
    <aside class="toggled">
      <div class="top">
        <div class="logo">
          <img src="../img/main/logo.svg" alt="Logo" />
          <span>Date Me - Dating App</span>
        </div>
        <nav>
          <a href="./" class="router-link-active">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M13 21c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6S16.309 21 13 21zM24 31c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6S27.309 31 24 31zM24 13c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5S26.757 13 24 13zM35 21c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6S38.309 21 35 21zM24 45c-5.047 0-9-2.636-9-6v-2.5c0-1.93 1.57-3.5 3.5-3.5h11c1.93 0 3.5 1.57 3.5 3.5V39C33 42.364 29.047 45 24 45zM13.21 35c.001 0 .002.001.003.001C13.868 32.696 15.988 31 18.5 31h.229C17.061 29.533 16 27.391 16 25c0-.692.097-1.359.263-2H7.5C5.57 23 4 24.57 4 26.5V29c0 3.36 3.95 6 9 6H13.21zM34.79 35c-.001 0-.002.001-.003.001C34.132 32.696 32.012 31 29.5 31h-.229C30.939 29.533 32 27.391 32 25c0-.692-.097-1.359-.263-2H40.5c1.93 0 3.5 1.57 3.5 3.5V29c0 3.36-3.95 6-9 6H34.79z"/></svg>
            <span>All Users</span>
          </a>
          <a href="./settings.php" >
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C22.423103 4 20.902664 4.1994284 19.451172 4.5371094 A 1.50015 1.50015 0 0 0 18.300781 5.8359375L17.982422 8.7382812C17.878304 9.6893592 17.328913 10.530853 16.5 11.009766C15.672739 11.487724 14.66862 11.540667 13.792969 11.15625L13.791016 11.15625L11.125 9.9824219 A 1.50015 1.50015 0 0 0 9.4257812 10.330078C7.3532865 12.539588 5.7626807 15.215064 4.859375 18.201172 A 1.50015 1.50015 0 0 0 5.4082031 19.845703L7.7734375 21.580078C8.5457929 22.147918 9 23.042801 9 24C9 24.95771 8.5458041 25.853342 7.7734375 26.419922L5.4082031 28.152344 A 1.50015 1.50015 0 0 0 4.859375 29.796875C5.7625845 32.782665 7.3519262 35.460112 9.4257812 37.669922 A 1.50015 1.50015 0 0 0 11.125 38.015625L13.791016 36.841797C14.667094 36.456509 15.672169 36.511947 16.5 36.990234C17.328913 37.469147 17.878304 38.310641 17.982422 39.261719L18.300781 42.164062 A 1.50015 1.50015 0 0 0 19.449219 43.460938C20.901371 43.799844 22.423103 44 24 44C25.576897 44 27.097336 43.800572 28.548828 43.462891 A 1.50015 1.50015 0 0 0 29.699219 42.164062L30.017578 39.261719C30.121696 38.310641 30.671087 37.469147 31.5 36.990234C32.327261 36.512276 33.33138 36.45738 34.207031 36.841797L36.875 38.015625 A 1.50015 1.50015 0 0 0 38.574219 37.669922C40.646713 35.460412 42.237319 32.782983 43.140625 29.796875 A 1.50015 1.50015 0 0 0 42.591797 28.152344L40.226562 26.419922C39.454197 25.853342 39 24.95771 39 24C39 23.04229 39.454197 22.146658 40.226562 21.580078L42.591797 19.847656 A 1.50015 1.50015 0 0 0 43.140625 18.203125C42.237319 15.217017 40.646713 12.539588 38.574219 10.330078 A 1.50015 1.50015 0 0 0 36.875 9.984375L34.207031 11.158203C33.33138 11.54262 32.327261 11.487724 31.5 11.009766C30.671087 10.530853 30.121696 9.6893592 30.017578 8.7382812L29.699219 5.8359375 A 1.50015 1.50015 0 0 0 28.550781 4.5390625C27.098629 4.2001555 25.576897 4 24 4 z M 24 7C24.974302 7 25.90992 7.1748796 26.847656 7.3398438L27.035156 9.0644531C27.243038 10.963375 28.346913 12.652335 30 13.607422C31.654169 14.563134 33.668094 14.673009 35.416016 13.904297L37.001953 13.207031C38.219788 14.669402 39.183985 16.321182 39.857422 18.130859L38.451172 19.162109C36.911538 20.291529 36 22.08971 36 24C36 25.91029 36.911538 27.708471 38.451172 28.837891L39.857422 29.869141C39.183985 31.678818 38.219788 33.330598 37.001953 34.792969L35.416016 34.095703C33.668094 33.326991 31.654169 33.436866 30 34.392578C28.346913 35.347665 27.243038 37.036625 27.035156 38.935547L26.847656 40.660156C25.910002 40.82466 24.973817 41 24 41C23.025698 41 22.09008 40.82512 21.152344 40.660156L20.964844 38.935547C20.756962 37.036625 19.653087 35.347665 18 34.392578C16.345831 33.436866 14.331906 33.326991 12.583984 34.095703L10.998047 34.792969C9.7799772 33.330806 8.8159425 31.678964 8.1425781 29.869141L9.5488281 28.837891C11.088462 27.708471 12 25.91029 12 24C12 22.08971 11.087719 20.290363 9.5488281 19.160156L8.1425781 18.128906C8.8163325 16.318532 9.7814501 14.667839 11 13.205078L12.583984 13.902344C14.331906 14.671056 16.345831 14.563134 18 13.607422C19.653087 12.652335 20.756962 10.963375 20.964844 9.0644531L21.152344 7.3398438C22.089998 7.1753403 23.026183 7 24 7 z M 24 16C19.599487 16 16 19.59949 16 24C16 28.40051 19.599487 32 24 32C28.400513 32 32 28.40051 32 24C32 19.59949 28.400513 16 24 16 z M 24 19C26.779194 19 29 21.220808 29 24C29 26.779192 26.779194 29 24 29C21.220806 29 19 26.779192 19 24C19 21.220808 21.220806 19 24 19 z"/></svg>
            <span>Settings</span>
          </a>
        </nav>
      </div>
      <a href="" class='logOut'>
        <svg xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M23.970703 3.9726562 A 2.0002 2.0002 0 0 0 22 6L22 22 A 2.0002 2.0002 0 1 0 26 22L26 6 A 2.0002 2.0002 0 0 0 23.970703 3.9726562 z M 17.03125 9.5957031 A 2.0002 2.0002 0 0 0 16.125 9.8105469C10.126881 12.732506 6 18.900262 6 26C6 35.917759 14.082241 44 24 44C33.917759 44 42 35.917759 42 26C42 18.900051 37.873521 12.733423 31.876953 9.8105469 A 2.0003292 2.0003292 0 1 0 30.123047 13.40625C34.782479 15.677373 38 20.447949 38 26C38 33.756241 31.756241 40 24 40C16.243759 40 10 33.756241 10 26C10 20.447738 13.215119 15.676291 17.875 13.40625 A 2.0002 2.0002 0 0 0 17.03125 9.5957031 z"/></svg>
        <span>Log Out</span>
      </a>
    </aside>
    <div class="router">
      <div class="router-page">
        <?php include 'top_nav.php'?>
        <div class="innerPage hasIn">
          <div class="form-page hasForm">
            <h1>Add New User</h1>
            <div class="form">
              <!-- <div class="logo">
                <img src="./img/main/logo.svg" alt="Meet Me Logo" draggable="false">
                <p>Date Me - Dating App</p>
              </div> -->
              <form action="" method="POST" enctype="multipart/form-data">
                <div class="parts">
                  <div class="crd">
                    <label>Name</label>
                    <div class="crd-input">
                      <input 
                        type="text" 
                        placeholder="Name" 
                        required
                        name="name"
                      />
                      <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C18.494917 4 14 8.494921 14 14C14 19.505079 18.494917 24 24 24C29.505083 24 34 19.505079 34 14C34 8.494921 29.505083 4 24 4 z M 24 7C27.883764 7 31 10.116238 31 14C31 17.883762 27.883764 21 24 21C20.116236 21 17 17.883762 17 14C17 10.116238 20.116236 7 24 7 z M 12.5 28C10.032499 28 8 30.032499 8 32.5L8 33.699219C8 36.640082 9.8647133 39.277974 12.708984 41.091797C15.553256 42.90562 19.444841 44 24 44C28.555159 44 32.446744 42.90562 35.291016 41.091797C38.135287 39.277974 40 36.640082 40 33.699219L40 32.5C40 30.032499 37.967501 28 35.5 28L12.5 28 z M 12.5 31L35.5 31C36.346499 31 37 31.653501 37 32.5L37 33.699219C37 35.364355 35.927463 37.127823 33.677734 38.5625C31.428006 39.997177 28.068841 41 24 41C19.931159 41 16.571994 39.997177 14.322266 38.5625C12.072537 37.127823 11 35.364355 11 33.699219L11 32.5C11 31.653501 11.653501 31 12.5 31 z"/></svg>
                      </div>
                    </div>
                  </div>
                  <div class="crd">
                    <label>Username</label>
                    <div class="crd-input">
                      <input 
                        type="text" 
                        placeholder="Username" 
                        required
                        name="username"
                      />
                      <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C18.494917 4 14 8.494921 14 14C14 19.505079 18.494917 24 24 24C29.505083 24 34 19.505079 34 14C34 8.494921 29.505083 4 24 4 z M 24 7C27.883764 7 31 10.116238 31 14C31 17.883762 27.883764 21 24 21C20.116236 21 17 17.883762 17 14C17 10.116238 20.116236 7 24 7 z M 12.5 28C10.032499 28 8 30.032499 8 32.5L8 33.699219C8 36.640082 9.8647133 39.277974 12.708984 41.091797C15.553256 42.90562 19.444841 44 24 44C28.555159 44 32.446744 42.90562 35.291016 41.091797C38.135287 39.277974 40 36.640082 40 33.699219L40 32.5C40 30.032499 37.967501 28 35.5 28L12.5 28 z M 12.5 31L35.5 31C36.346499 31 37 31.653501 37 32.5L37 33.699219C37 35.364355 35.927463 37.127823 33.677734 38.5625C31.428006 39.997177 28.068841 41 24 41C19.931159 41 16.571994 39.997177 14.322266 38.5625C12.072537 37.127823 11 35.364355 11 33.699219L11 32.5C11 31.653501 11.653501 31 12.5 31 z"/></svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="parts">
                  <div class="crd">
                    <label>Password</label>
                    <div class="crd-input">
                      <input
                        type="password"
                        placeholder="Password"
                        required
                        name="password"
                      />
                      <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C19.599415 4 16 7.599415 16 12L16 16L12.5 16C10.032499 16 8 18.032499 8 20.5L8 39.5C8 41.967501 10.032499 44 12.5 44L35.5 44C37.967501 44 40 41.967501 40 39.5L40 20.5C40 18.032499 37.967501 16 35.5 16L32 16L32 12C32 7.599415 28.400585 4 24 4 z M 24 7C26.779415 7 29 9.220585 29 12L29 16L19 16L19 12C19 9.220585 21.220585 7 24 7 z M 12.5 19L35.5 19C36.346499 19 37 19.653501 37 20.5L37 39.5C37 40.346499 36.346499 41 35.5 41L12.5 41C11.653501 41 11 40.346499 11 39.5L11 20.5C11 19.653501 11.653501 19 12.5 19 z M 17 28 A 2 2 0 0 0 17 32 A 2 2 0 0 0 17 28 z M 24 28 A 2 2 0 0 0 24 32 A 2 2 0 0 0 24 28 z M 31 28 A 2 2 0 0 0 31 32 A 2 2 0 0 0 31 28 z"/></svg>
                      </div>
                    </div>
                  </div>
                  <div class="crd">
                    <label>Gender</label>
                    <div class="crd-input">
                      <select name="gender" id="">
                        <option value="" selected disabled hidden>Choose Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                      </select>
                      <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C19.599415 4 16 7.599415 16 12L16 16L12.5 16C10.032499 16 8 18.032499 8 20.5L8 39.5C8 41.967501 10.032499 44 12.5 44L35.5 44C37.967501 44 40 41.967501 40 39.5L40 20.5C40 18.032499 37.967501 16 35.5 16L32 16L32 12C32 7.599415 28.400585 4 24 4 z M 24 7C26.779415 7 29 9.220585 29 12L29 16L19 16L19 12C19 9.220585 21.220585 7 24 7 z M 12.5 19L35.5 19C36.346499 19 37 19.653501 37 20.5L37 39.5C37 40.346499 36.346499 41 35.5 41L12.5 41C11.653501 41 11 40.346499 11 39.5L11 20.5C11 19.653501 11.653501 19 12.5 19 z M 17 28 A 2 2 0 0 0 17 32 A 2 2 0 0 0 17 28 z M 24 28 A 2 2 0 0 0 24 32 A 2 2 0 0 0 24 28 z M 31 28 A 2 2 0 0 0 31 32 A 2 2 0 0 0 31 28 z"/></svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="parts">
                  <div class="crd">
                    <label>Email</label>
                    <div class="crd-input">
                      <input
                        type="email"
                        placeholder="Password"
                        required
                        name="email"
                      />
                      <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C19.599415 4 16 7.599415 16 12L16 16L12.5 16C10.032499 16 8 18.032499 8 20.5L8 39.5C8 41.967501 10.032499 44 12.5 44L35.5 44C37.967501 44 40 41.967501 40 39.5L40 20.5C40 18.032499 37.967501 16 35.5 16L32 16L32 12C32 7.599415 28.400585 4 24 4 z M 24 7C26.779415 7 29 9.220585 29 12L29 16L19 16L19 12C19 9.220585 21.220585 7 24 7 z M 12.5 19L35.5 19C36.346499 19 37 19.653501 37 20.5L37 39.5C37 40.346499 36.346499 41 35.5 41L12.5 41C11.653501 41 11 40.346499 11 39.5L11 20.5C11 19.653501 11.653501 19 12.5 19 z M 17 28 A 2 2 0 0 0 17 32 A 2 2 0 0 0 17 28 z M 24 28 A 2 2 0 0 0 24 32 A 2 2 0 0 0 24 28 z M 31 28 A 2 2 0 0 0 31 32 A 2 2 0 0 0 31 28 z"/></svg>
                      </div>
                    </div>
                  </div>
                  <div class="crd">
                    <label>Age</label>
                    <div class="crd-input">
                      <input
                        type="date"
                        placeholder="Age"
                        required
                        name="age"
                      />
                      <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M24 4C19.599415 4 16 7.599415 16 12L16 16L12.5 16C10.032499 16 8 18.032499 8 20.5L8 39.5C8 41.967501 10.032499 44 12.5 44L35.5 44C37.967501 44 40 41.967501 40 39.5L40 20.5C40 18.032499 37.967501 16 35.5 16L32 16L32 12C32 7.599415 28.400585 4 24 4 z M 24 7C26.779415 7 29 9.220585 29 12L29 16L19 16L19 12C19 9.220585 21.220585 7 24 7 z M 12.5 19L35.5 19C36.346499 19 37 19.653501 37 20.5L37 39.5C37 40.346499 36.346499 41 35.5 41L12.5 41C11.653501 41 11 40.346499 11 39.5L11 20.5C11 19.653501 11.653501 19 12.5 19 z M 17 28 A 2 2 0 0 0 17 32 A 2 2 0 0 0 17 28 z M 24 28 A 2 2 0 0 0 24 32 A 2 2 0 0 0 24 28 z M 31 28 A 2 2 0 0 0 31 32 A 2 2 0 0 0 31 28 z"/></svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="parts-img">
                  <div class="crd-image">
                    <label class="first-prev" id="profilepreview" for="profile">
                      <img src="" alt="" id="imagePrev">
                      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><path d="M11.5 6C8.4802259 6 6 8.4802259 6 11.5L6 36.5C6 39.519774 8.4802259 42 11.5 42L36.5 42C39.519774 42 42 39.519774 42 36.5L42 11.5C42 8.4802259 39.519774 6 36.5 6L11.5 6 z M 11.5 9L36.5 9C37.898226 9 39 10.101774 39 11.5L39 31.955078L32.988281 26.138672 A 1.50015 1.50015 0 0 0 32.986328 26.136719C32.208234 25.385403 31.18685 25 30.173828 25C29.16122 25 28.13988 25.385387 27.361328 26.138672L25.3125 28.121094L19.132812 22.142578C18.35636 21.389748 17.336076 21 16.318359 21C15.299078 21 14.280986 21.392173 13.505859 22.140625 A 1.50015 1.50015 0 0 0 13.503906 22.142578L9 26.5L9 11.5C9 10.101774 10.101774 9 11.5 9 z M 30.5 13C29.125 13 27.903815 13.569633 27.128906 14.441406C26.353997 15.313179 26 16.416667 26 17.5C26 18.583333 26.353997 19.686821 27.128906 20.558594C27.903815 21.430367 29.125 22 30.5 22C31.875 22 33.096185 21.430367 33.871094 20.558594C34.646003 19.686821 35 18.583333 35 17.5C35 16.416667 34.646003 15.313179 33.871094 14.441406C33.096185 13.569633 31.875 13 30.5 13 z M 30.5 16C31.124999 16 31.403816 16.180367 31.628906 16.433594C31.853997 16.686821 32 17.083333 32 17.5C32 17.916667 31.853997 18.313179 31.628906 18.566406C31.403816 18.819633 31.124999 19 30.5 19C29.875001 19 29.596184 18.819633 29.371094 18.566406C29.146003 18.313179 29 17.916667 29 17.5C29 17.083333 29.146003 16.686821 29.371094 16.433594C29.596184 16.180367 29.875001 16 30.5 16 z M 16.318359 24C16.578643 24 16.835328 24.09366 17.044922 24.296875 A 1.50015 1.50015 0 0 0 17.046875 24.298828L23.154297 30.207031L14.064453 39L11.5 39C10.101774 39 9 37.898226 9 36.5L9 30.673828L15.589844 24.298828C15.802764 24.093234 16.059641 24 16.318359 24 z M 30.173828 28C30.438806 28 30.692485 28.09229 30.902344 28.294922L39 36.128906L39 36.5C39 37.898226 37.898226 39 36.5 39L18.380859 39L29.447266 28.294922C29.654714 28.094207 29.910436 28 30.173828 28 z"/></svg>
                    </label>
                    <input type="file" name="profile" id="profile" accept="image/*">
                  </div>
                </div>
                <button type="submit" name="add">Add User</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script>
    let inpt = document.querySelector('#profile');
    let img = document.querySelector('#imagePrev');
    inpt.addEventListener('input', ev => {
      let url = URL.createObjectURL(ev.target.files[0]);
      let label = document.querySelector('#profilepreview');
      label.classList.remove('first-prev');
      img.src = url;
    })
  </script>
  
</body>
</html>